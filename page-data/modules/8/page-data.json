{"componentChunkName":"component---src-templates-mdx-pages-js","path":"/modules/8/","result":{"data":{"mdx":{"id":"682a55c4-4a50-5093-8d05-06e45a976fb1","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Module 8 : SPA & sessions & déploiement\",\n  \"description\": \"Gestion de session utilisateurs pour suivre des opérations sur des ressources & déploiement de SPA sur le cloud\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar ScrollableImage = makeShortcode(\"ScrollableImage\");\nvar LinkFile = makeShortcode(\"LinkFile\");\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", null, \"Module 8 : SPA & sessions & d\\xE9ploiement\"), mdx(\"p\", null, \"Ce module vous offre principalement la gestion de session utilisateurs pour faciliter les op\\xE9rations sur des ressources ainsi que le d\\xE9ploiement de SPA sur le cloud.\"), mdx(\"p\", null, \"Voici les sujets trait\\xE9s :\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"a) \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#a\"\n  }, \"Gestion de sessions c\\xF4t\\xE9 client\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"a.1) \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#a1\"\n  }, \"Introduction\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"a.2) \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#a2\"\n  }, \"Persistance de donn\\xE9es de sessions via le web storage\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"a.3) \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#a3\"\n  }, \"Persistance de donn\\xE9es de session via des cookies\")))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"b) \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#b\"\n  }, \"Exercice 8.1 : Persistance de la session de myMovies dans le web storage\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"c) \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#d\"\n  }, \"D\\xE9ploiement d'applications sur le cloud\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"c.1) \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#c1\"\n  }, \"Introduction\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"c.2) \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#c2\"\n  }, \"D\\xE9ploiement d'un frontend sur GitHub Pages\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"c.3) \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#c3\"\n  }, \"D\\xE9ploiement d'une API sur Heroku\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"c.4) \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#c4\"\n  }, \"D\\xE9ploiement d'une API sur des providers gratuits\")))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"d) \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#d\"\n  }, \"Exercice 8.2 : D\\xE9ploiement de myMovies sur le cloud\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"e) \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#e\"\n  }, \"\\uD83C\\uDF6C Exercice 8.3 : l'essentiel du cours en action\"))), mdx(\"h1\", null, mdx(\"a\", {\n    id: \"a\"\n  }), \" a) Gestion de sessions c\\xF4t\\xE9 client\"), mdx(\"h2\", null, mdx(\"a\", {\n    id: \"a1\"\n  }), \" a.1) Introduction\"), mdx(\"p\", null, \"Nous avons vu qu'une des exigences associ\\xE9es \\xE0 la cr\\xE9ation d'une application selon l'architecture REST, c'est qu'elle soit \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"stateless\"), \", c'est \\xE0 dire que l'API ne doit pas garder l'\\xE9tat du client, sa session, c\\xF4t\\xE9 serveur.\"), mdx(\"p\", null, \"C'est donc au client de sauvegarder ses donn\\xE9es de session.\"), mdx(\"p\", null, \"Pour rappel, nous avons d\\xE9j\\xE0 vu les avantages et les inconv\\xE9nients d'avoir un serveur \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"stateless\"), \" par rapport \\xE0 un serveur \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"stateful\"), \" lorsque nous avons trait\\xE9 de l'authentification : \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/web3/modules/7/#a1.4\"\n  }, \"Module 7 : a.1.4) Stateful VS stateless authentication\"), \".\"), mdx(\"p\", null, \"Mais o\\xF9 pouvons nous sauvegarder des donn\\xE9es de mani\\xE8re persistantes c\\xF4t\\xE9 client ?\"), mdx(\"p\", null, \"Il existe deux principales fa\\xE7on de sauvegarder de l'info dans un browser :\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"le \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"web storage\"), \" ; \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"les \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"cookies\"), \".\")), mdx(\"p\", null, \"Dans le cadre de ce cours, nous allons voir comment sauvegarder de l'info \\xE0 l'aide de ces deux fa\\xE7ons.\"), mdx(\"p\", null, \"NB : le browser met \\xE0 disposition d'autres API un peu moins connues pour sauvegarder des infos. Nous ne les verrons pas dans le cadre de ce cours, mais il reste n\\xE9anmoins int\\xE9ressant de voir de quoi il s'agit :\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"IndexedDB API\"), \" : permet de sauvegarder c\\xF4t\\xE9 client de grandes quantit\\xE9 d'infos structur\\xE9es, incluant des fichiers ; c'est une base de donn\\xE9es orient\\xE9e objets en JS qui permet les transactions.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Cache API\"), \" : permet d'enregistrer et retrouver des requ\\xEAtes et leur r\\xE9ponses. Bien qu'\\xE0 la base cr\\xE9\\xE9 pour pouvoir fournir des r\\xE9ponses plus rapides \\xE0 certaines requ\\xEAtes, cette API peut aussi \\xEAtre utilis\\xE9e comme m\\xE9canisme g\\xE9n\\xE9ral de stockage.\")), mdx(\"h2\", null, mdx(\"a\", {\n    id: \"a2\"\n  }), \" a.2) Persistance de donn\\xE9es de sessions via le web storage\"), mdx(\"h3\", null, \"a.2.1 Introduction\"), mdx(\"p\", null, \"Le \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Web Storage API\"), \" fournit un m\\xE9canisme permettant aux browser d'enregistrer des paires \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"cl\\xE9 / valeur\"), \" d'une mani\\xE8re plus intuitive que l'utilisation de cookies.\"), mdx(\"p\", null, \"Il existe deux m\\xE9canismes au sein du web storage :\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"sessionStorage\"), \" :\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"offre un espace de stockage s\\xE9par\\xE9 pour chaque origine pour la dur\\xE9e de la session d'une page, tant que le browser est ouvert.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"les cl\\xE9s / valeurs sont enregistr\\xE9e sous forme de string uniquement ;\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"espace de stockage plus grand qu'un cookie, ~5MB maximum ;\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"localStorage\"), \" : \", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"offre aussi un espace de stockage s\\xE9par\\xE9 pour chaque origine, mais les donn\\xE9es persistent quand le browser est ferm\\xE9 et r\\xE9ouvert ;\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"espace de stockage plus grand qu'un cookie, limit\\xE9 \\xE0 ~10MB en cas de crash/restart du browser.\")))), mdx(\"p\", null, \"Les principales m\\xE9thodes offertes par \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"sessionStorage\"), \" et \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"localStorage\"), \" sont les m\\xEAmes. Voici quelques exemples de codes par m\\xE9thode.\"), mdx(\"h3\", null, \"a.2.2 setItem()\"), mdx(\"p\", null, \"Cette m\\xE9thode permet d'enregistrer, pour une cl\\xE9 donn\\xE9e, la valeur associ\\xE9e :\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\",\n    \"metastring\": \"numbered {5}\",\n    \"numbered\": true,\n    \"{5}\": true\n  }, \"const\\xA0STORE_NAME\\xA0=\\xA0'user';\\n\\nconst\\xA0setUserSessionData\\xA0=\\xA0(user)\\xA0=>\\xA0{\\n\\xA0\\xA0const\\xA0storageValue\\xA0=\\xA0JSON.stringify(user);\\n\\xA0\\xA0localStorage.setItem(STORE_NAME,\\xA0storageValue);\\n};\\n\")), mdx(\"p\", null, \"Comme le web storage est un syst\\xE8me de cl\\xE9 / valeur qui enregistre les donn\\xE9es sous forme de string, cela vous rappelle p-e qu'il est possible d'enregistrer des objets. \"), mdx(\"p\", null, \"\\uD83D\\uDCAD Comment enregistrer un objet JS sous forme de string ?\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"H\\xE9 bien il suffit de le s\\xE9rialiser, comme cela est fait dans l'exemple \\xE0 l'aide de la m\\xE9thode \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"strong\"\n  }, \"JSON.stringify()\")), \".\"), mdx(\"h3\", null, \"a.2.3 getItem()\"), mdx(\"p\", null, \"Cette m\\xE9thode permet d'obtenir la valeur associ\\xE9e \\xE0 la cl\\xE9 donn\\xE9e en argument :\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\",\n    \"metastring\": \"numbered {4}\",\n    \"numbered\": true,\n    \"{4}\": true\n  }, \"const\\xA0STORE_NAME\\xA0=\\xA0'user';\\n\\nconst\\xA0getUserSessionData\\xA0=\\xA0()\\xA0=>\\xA0{\\n\\xA0\\xA0const\\xA0retrievedUser\\xA0=\\xA0localStorage.getItem(STORE_NAME);\\n\\xA0\\xA0if\\xA0(!retrievedUser)\\xA0return;\\n\\xA0\\xA0return\\xA0JSON.parse(retrievedUser);\\n};\\n\")), mdx(\"p\", null, \"Pour cet exemple, comme la valeur a \\xE9t\\xE9 s\\xE9rialis\\xE9e, nous pouvons r\\xE9cup\\xE9rer l'objet gr\\xE2ce \\xE0 la m\\xE9thode \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"strong\"\n  }, \"JSON.parse()\")), \".\"), mdx(\"h3\", null, \"a.2.4 removeITem()\"), mdx(\"p\", null, \"Cette m\\xE9thode permet d'effacer une cl\\xE9 / valeur :\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\",\n    \"metastring\": \"numbered {4}\",\n    \"numbered\": true,\n    \"{4}\": true\n  }, \"const\\xA0STORE_NAME\\xA0=\\xA0'user';\\n\\nconst\\xA0removeSessionData\\xA0=\\xA0()\\xA0=>\\xA0{\\n\\xA0\\xA0localStorage.removeItem(STORE_NAME);\\n};\\n\")), mdx(\"h3\", null, \"a.2.5 clear()\"), mdx(\"p\", null, \"Cette m\\xE9thode permet d'effacer tout l'espace de stockage pour une origine donn\\xE9e.\"), mdx(\"p\", null, \"Cette m\\xE9thode est tr\\xE8s utile lorsque l'on souhaite effacer toute la session d'un utilisateur, notamment lors du logout d'un utilisateur.\"), mdx(\"h3\", null, \"Mise en place du localStorage pour sauvegarder les donn\\xE9es de session\"), mdx(\"p\", null, \"Dans le cadre du site nous permettant de g\\xE9rer une pizzeria, nous allons faire en sorte de sauvegarder les donn\\xE9es de session au sein du \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"localStorage\"), \", et plus juste en m\\xE9moire vive.\"), mdx(\"p\", null, \"Veuillez d\\xE9marrer la derni\\xE8re version de la RESTful API de la pizzeria. En cas de souci, vous pouvez utiliser ce code-ci :\\n\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/safe\"\n  }, \"safe\"), \".\"), mdx(\"p\", null, \"Nous allons maintenant finaliser le d\\xE9veloppement de l'IHM \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/e-vinci/js-demos/tree/main/frontend/frontend-essentials/jwt-fetch\"\n  }, \"jwt-fetch\"), \".\"), mdx(\"p\", null, \"Au sein de votre repo \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"web2\"), \", veuillez cr\\xE9er le projet nomm\\xE9 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/web2/tutorials/pizzeria/hmi/web-storage\"), \" sur base d'un copi\\xE9 coll\\xE9 de \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/web2/tutorials/pizzeria/hmi/jwt-fetch\"), \" (ou \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/e-vinci/js-demos/tree/main/frontend/frontend-essentials/jwt-fetch\"\n  }, \"jwt-fetch\"), \").\"), mdx(\"p\", null, \"Pour la suite du tutoriel, nous consid\\xE9rons que tous les chemins absolus d\\xE9marrent du r\\xE9pertoire\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/web2/tutorials/pizzeria/hmi/web-storage\"), \".\"), mdx(\"p\", null, \"Afin de sauvegarder les donn\\xE9es de session, c'est \\xE0 dire l'objet \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"authenticatedUser\"), \" contenant un token et un username, nous devons juste mettre \\xE0 jour le fichier \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/usr/utils/auths.js\"), \" :\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\",\n    \"metastring\": \"numbered {1,7,10,15-16,24}\",\n    \"numbered\": true,\n    \"{1,7,10,15-16,24}\": true\n  }, \"const STORE_NAME = 'user';\\nlet currentUser;\\n\\nconst getAuthenticatedUser = () => {\\n  if (currentUser !== undefined) return currentUser;\\n\\n  const serializedUser = localStorage.getItem(STORE_NAME);\\n  if (!serializedUser) return undefined;\\n\\n  currentUser = JSON.parse(serializedUser);\\n  return currentUser;\\n};\\n\\nconst setAuthenticatedUser = (authenticatedUser) => {\\n  const serializedUser = JSON.stringify(authenticatedUser);\\n  localStorage.setItem(STORE_NAME, serializedUser);\\n\\n  currentUser = authenticatedUser;\\n};\\n\\nconst isAuthenticated = () => currentUser !== undefined;\\n\\nconst clearAuthenticatedUser = () => {\\n  localStorage.removeItem(STORE_NAME);\\n  currentUser = undefined;\\n};\\n\\n// eslint-disable-next-line object-curly-newline\\nexport { getAuthenticatedUser, setAuthenticatedUser, isAuthenticated, clearAuthenticatedUser };\\n\")), mdx(\"p\", null, \"Au sein de \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"strong\"\n  }, \"getAuthenticatedUser\")), \" : \"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"on fait un premier check afin d'\\xE9viter d'aller lire dans le \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"localStorage\"), \" si la variable \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"currentUser\"), \" est d\\xE9j\\xE0 initialis\\xE9e.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"on parse l'utilisateur authentifi\\xE9 et s\\xE9rialis\\xE9 qui est retrouv\\xE9 dans le \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"localStorage\"), \" via la cl\\xE9 \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"STORE_NAME\"), \".\")), mdx(\"p\", null, \"Au sein de \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"strong\"\n  }, \"setAuthenticatedUser\")), \", on s\\xE9rialise \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"authenticatedUser\"), \" avant d'ajouter une paire cl\\xE9 / valeur au \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"localStorage\"), \".  Ces donn\\xE9es restent dans le browser, peu importe le nombre de fois que l'on ferme son browser. \"), mdx(\"p\", null, \"Dans \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"strong\"\n  }, \"clearAuthenticatedUser\")), \", on efface la cl\\xE9 / valeur associ\\xE9e \\xE0 l'utilisateur authentifi\\xE9 (via la cl\\xE9 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"STORE_NAME\"), \").\"), mdx(\"p\", null, \"Veuillez bien mettre \\xE0 jour votre code et tester l'application.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Connectez-vous \\xE0 l'aide de l'utilisateur \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"manager\"), \".  Veuillez fermer votre browser.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Veuillez le r\\xE9ouvrir.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Voil\\xE0, vous devriez automatiquement \\xEAtre authentifi\\xE9, veuillez observer l'\\xE9tat de la Navbar pour vous en assurer.\"), mdx(\"p\", null, \"\\uD83D\\uDCAD O\\xF9 puis-je observer l'\\xE9tat des donn\\xE9es sauvegard\\xE9es dans le web storage de mon browser ?\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Tout en ayant la fen\\xEAtre de votre application ouverte, via Chrome, allez dans vos outils de d\\xE9veloppeurs : \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"F12\"), \".\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Puis, dans l'onglet \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Application\"), \", vous trouverez dans \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Storage\"), \" : \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Local Storage\"), \" et \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Session Storage\"), \".\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Ici, nous utilisons le \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Local Storage\"), \", donc cliquez dessus, vous verrez appara\\xEEtre \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://localhost:8080\"), \". Cliquez sur cette URL, et vous verrez vos donn\\xE9es de session, quelque chose du style \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"{\\\"username\\\":\\\"manager\\\",\\\"token\\\":\\\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Im1hbmFnZXIiLCJpYXQiOjE2NjE3NjM3MDksImV4cCI6MTc0ODE2MzcwOX0.jAxH0WsOgiK5vf4QduDZ8JgTR-SKC42G9aPieV_OTOo\\\"}\"), \".\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"N'h\\xE9sitez pas \\xE0 faire un clic droit sur l'URL \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://localhost:8080\"), \", puis \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Clear\"), \".\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Si vous faites ensuite un refresh de votre page, comme votre session aura \\xE9t\\xE9 effac\\xE9e, votre utilisateur ne sera plus connect\\xE9. Votre Navbar afficher le menu pour un utilisateur anonyme !\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Faites ce test, c'est int\\xE9ressant \\uD83D\\uDE09.\"), mdx(\"p\", null, \"Si tout fonctionne bien, faites un \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"commit\"), \" de votre repo (\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"web2\"), \") avec le message\\n\\\"\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"web storage\"), \"\\\".\"), mdx(\"p\", null, \"En cas de souci, vous pouvez utiliser le code du tutoriel :\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"pour le frontend : \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/e-vinci/js-demos/tree/main/frontend/frontend-essentials/web-storage\"\n  }, \"web-storage\"), \".\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"pour l'API : \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/safe\"\n  }, \"safe\"), \".\")), mdx(\"h2\", null, mdx(\"a\", {\n    id: \"a3\"\n  }), \" a.3) Persistance de donn\\xE9es de session via des cookies\"), mdx(\"h3\", null, \"Introduction\"), mdx(\"p\", null, \"Un cookie repr\\xE9sente des donn\\xE9es qu'un serveur envoie \\xE0 un browser.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Le browser peut sauver ce cookie. Pour chaque requ\\xEAte faite au serveur sur la m\\xEAme origine (que l'origine o\\xF9 le cookie a \\xE9t\\xE9 re\\xE7u), le cookie sera automatiquement envoy\\xE9 au serveur.\"), mdx(\"p\", null, \"Il fut un temps o\\xF9 les cookies \\xE9taient utilis\\xE9 comme un m\\xE9canisme g\\xE9n\\xE9ral de stockage de donn\\xE9es c\\xF4t\\xE9 client. \"), mdx(\"p\", null, \"\\uD83D\\uDC4D Actuellement, si les cookies sont utilis\\xE9s pour sauvegarder les donn\\xE9es de session, il faut se prot\\xE9ger contre les attaques XSS et rendre les cookies inaccessibles au JavaScript. On utilise donc les cookies \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"HttpOnly\"), \" qui sont inaccessibles \\xE0 la \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Document.cookie API\"), \". \"), mdx(\"p\", null, \"Du coup, si des donn\\xE9es de session doivent \\xEAtre utilis\\xE9e pour l'IHM, on ne peut pas se passer du \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"web storage\"), \" !\"), mdx(\"p\", null, \"Pour la suite, on va donc voir :\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"comment utiliser Express pour cr\\xE9er des cookies au niveau d'une API ;\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"pour rendre ces cookies inaccessibles aux attaques XSS en configurant \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"HttpOnly\"), \" ;\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"comme les cookies sont envoy\\xE9s automatiquement au serveur, il faudra mettre \\xE0 jour notre IHM pour ne plus envoyer le token via un authorization header. L'API va charger le token dans le cookie, et comme le cookie sera automatiquement envoy\\xE9 au serveur via le browser, l'IHM et les fetch seront plus simples. \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"l'emb\\xEAtant dans ce que nous allons faire, c'est que comme nous allons s\\xE9curiser le cookie, nous n'aurons pas acc\\xE8s au username via le cookie... Nous pourrions :\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"soit toujours utiliser le web storage pour sauvegarder le username, \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"soit accepter de ne plus afficher le nom du username et avoir aucun nouveau code \\xE0 ajouter au niveau du frontend (juste enlever les authorization header inutiles) ;\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"soit mettre \\xE0 jour l'API pour offrir une route de type \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"GET /users/me\"), \" qui renvoie les donn\\xE9es d'un utilisateur \\xE0 la demande d'une requ\\xEAte cliente. Dans ce cas-l\\xE0, \\xE0 chaque fois que l'utilisateur ouvre le browser, la premi\\xE8re chose \\xE0 faire serait d'appeler cette op\\xE9ration.\")))), mdx(\"p\", null, \"Pour le tutoriel, nous avons choisi la premi\\xE8re option. Dans vos exercices optionnels, n'h\\xE9sitez pas \\xE0 explorer une autre option.\"), mdx(\"p\", null, \"\\uD83D\\uDCAD Mais pourquoi s\\xE9curiser le cookie et le rendre inaccessible au JS ?\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"H\\xE9 bien, imaginez qu'un attaquant arrive \\xE0 faire une attaque XSS, via un JS malicieux, renvoyant le cookie de chaque utilisateur qui affiche le menu des pizzas...\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Via ce cookie, qui contient le token de l'utilisateur, le pirate peut se faire passer pour l'utilisateur pirat\\xE9 !\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Bon, pour la pizzeria, c'est p-e pas si grave, mais imaginez si c'est le token associ\\xE9 \\xE0 votre compte banquaire !\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Si le cookie est inaccessible au JS, il est donc impossible pour un hackeur, via du JS malicieux, d'acc\\xE9der au token, et donc, de l'envoyer \\uD83D\\uDE0C.\"), mdx(\"h3\", null, \"Gestion de session c\\xF4t\\xE9 client via Express pour une API\"), mdx(\"p\", null, \"Nous allons donc cr\\xE9er une nouvelle version de l'API sauvegardant le token d'un utilisateur au sein d'un cookie, ainsi que son username, sans que ces infos soient accessible au JS c\\xF4t\\xE9 client.\"), mdx(\"p\", null, \"Pour ce faire nous allons utiliser la librairie \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/expressjs/cookie-session\"\n  }, \"cookie-session\"), \" qui permet d'enregistrer des donn\\xE9es de session dans des cookies.\"), mdx(\"p\", null, \"Nous allons maintenant continuer le d\\xE9veloppement de l'API \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/safe\"\n  }, \"safe\"), \".\"), mdx(\"p\", null, \"Au sein de votre repo \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"web2\"), \", veuillez cr\\xE9er le projet nomm\\xE9 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/web2/tutorials/pizzeria/api/cookies\"), \" sur base d'un copi\\xE9 coll\\xE9 de \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/web2/tutorials/pizzeria/api/safe\"), \" (ou \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/safe\"\n  }, \"safe\"), \".\"), mdx(\"p\", null, \"Pour la suite du tutoriel, nous consid\\xE9rons que tous les chemins absolus d\\xE9marrent du r\\xE9pertoire\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/web2/tutorials/pizzeria/api/cookies\"), \".\"), mdx(\"p\", null, \"Veuillez installer la librairie \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"jsonwebtoken\"), \" au sein de votre nouveau projet \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"auths\"), \" :\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"npm i cookie-session\\n\")), mdx(\"h4\", null, \"Utilisation de la fonction middleware \", mdx(\"inlineCode\", {\n    parentName: \"h4\"\n  }, \"cookieSession\")), mdx(\"p\", null, \"Veuillez mettre \\xE0 jour \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/app.json\"), \" pour mettre en place la gestion de cookies :\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\",\n    \"metastring\": \"{4,12-23}\",\n    \"{4,12-23}\": true\n  }, \"const express = require('express');\\nconst cookieParser = require('cookie-parser');\\nconst logger = require('morgan');\\nconst cookieSession = require('cookie-session');\\n\\nconst usersRouter = require('./routes/users');\\nconst pizzaRouter = require('./routes/pizzas');\\nconst authsRouter = require('./routes/auths');\\n\\nconst app = express();\\n\\nconst expiryDateIn3Months = new Date(Date.now() + 1000 * 60 * 60 * 24 * 30 * 3);\\nconst cookieSecreteKey = 'YouWouldnot!not!like!mypizza';\\napp.use(\\n  cookieSession({\\n    name: 'user',\\n    keys: [cookieSecreteKey],\\n    cookie: {\\n      httpOnly: true,\\n      expires: expiryDateIn3Months,\\n    },\\n  }),\\n);\\n\\napp.use(logger('dev'));\\napp.use(express.json());\\napp.use(express.urlencoded({ extended: false }));\\napp.use(cookieParser());\\n\\napp.use('/users', usersRouter);\\napp.use('/pizzas', pizzaRouter);\\napp.use('/auths', authsRouter);\\n\\nmodule.exports = app;\\n\")), mdx(\"p\", null, \"Nous avons donc bien indiqu\\xE9 que le cookie est inaccessible au JS via : \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"httpOnly: true,\"), \".\"), mdx(\"p\", null, \"Nous avons fait en sorte que le cookie soit sign\\xE9 via la cl\\xE9 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cookieSecreteKey\"), \".\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Le m\\xE9canisme de signature correspond \\xE0 ce qui a \\xE9t\\xE9 vu dans le cadre des tokens JWT.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Ainsi, si un cookie venait \\xEAtre modifi\\xE9 par un utilisateur, lors de la v\\xE9rification du cookie, cela sera automatiquement d\\xE9tect\\xE9 par la fonction middleware \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cookieSession\"), \" et la session ne sera pas cr\\xE9\\xE9e.\"), mdx(\"p\", null, \"Pour info, la fonction middleware \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cookieSession\"), \" va cr\\xE9\\xE9 deux cookies :\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"un cookie portant comme nom la valeur de \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"name\"), \" ; il est encod\\xE9 en base64. N'h\\xE9sitez pas \\xE0 vous amuser \\xE0 d\\xE9coder un cookie g\\xE9n\\xE9r\\xE9 par \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"cookieSession\"), \" sur \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://www.base64decode.org/\"\n  }, \"base64decode\"), \".\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"un cookie portant comme nom la valeur de \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"name\"), \" + \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \".sig\"), \" : c'est la signature qui pr\\xE9vient contre le \\\"tempering\\\" (acte intentionnel mais non autoris\\xE9 qui am\\xE8ne \\xE0 la modification d'un syst\\xE8me ou de donn\\xE9es).\")), mdx(\"h4\", null, \"Lecture et ajout de donn\\xE9es de session via \", mdx(\"inlineCode\", {\n    parentName: \"h4\"\n  }, \"req.session\")), mdx(\"p\", null, \"Pour cr\\xE9er des donn\\xE9es de session, il suffit de simplement les ajouter \\xE0 l'objet \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"strong\"\n  }, \"req.session\")), \".\"), mdx(\"p\", null, \"Dans le cadre de la RESTful API g\\xE9rant les pizzas, cela est fait lors d'une op\\xE9ration de type \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"register\"), \" ou \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"login\"), \".\"), mdx(\"p\", null, \"Veuillez mettre \\xE0 jour le router \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/routes/auths.js\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\",\n    \"metastring\": \"numbered {17,19,33,35,38-42,44-47}\",\n    \"numbered\": true,\n    \"{17,19,33,35,38-42,44-47}\": true\n  }, \"const express = require('express');\\nconst { register, login } = require('../models/users');\\n\\nconst router = express.Router();\\n\\n/* Register a user */\\nrouter.post('/register', async (req, res) => {\\n  const username = req?.body?.username?.length !== 0 ? req.body.username : undefined;\\n  const password = req?.body?.password?.length !== 0 ? req.body.password : undefined;\\n\\n  if (!username || !password) return res.sendStatus(400); // 400 Bad Request\\n\\n  const authenticatedUser = await register(username, password);\\n\\n  if (!authenticatedUser) return res.sendStatus(409); // 409 Conflict\\n\\n  createCookieSessionData(req, authenticatedUser);\\n\\n  return res.json({ username: authenticatedUser.username });\\n});\\n\\n/* Login a user */\\nrouter.post('/login', async (req, res) => {\\n  const username = req?.body?.username?.length !== 0 ? req.body.username : undefined;\\n  const password = req?.body?.password?.length !== 0 ? req.body.password : undefined;\\n\\n  if (!username || !password) return res.sendStatus(400); // 400 Bad Reques\\n\\n  const authenticatedUser = await login(username, password);\\n\\n  if (!authenticatedUser) return res.sendStatus(401); // 401 Unauthorized\\n\\n  createCookieSessionData(req, authenticatedUser);\\n\\n  return res.json({ username: authenticatedUser.username });\\n});\\n\\n/* Logout a user */\\nrouter.get('/logout', (req, res) => {\\n  req.session = null;\\n  return res.sendStatus();\\n});\\n\\nfunction createCookieSessionData(req, authenticatedUser) {\\n  req.session.username = authenticatedUser.username;\\n  req.session.token = authenticatedUser.token;\\n}\\n\\nmodule.exports = router;\\n\")), mdx(\"p\", null, \"Dans le code ci-dessus, nous pr\\xE9parons les donn\\xE9es de session qui seront \\xE9crites dans le cookie \\xE0 l'aide de l'objet \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"req.session\"), \".\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Lorsque nous renvoyons du JSON aux clients, nous ne renvoyons plus le token, mais juste le username de l'utilisateur. L'application cliente, le browser, pourra utiliser cette info pour afficher le nom de l'utilisateur. Pour rappel, le browser n'a pas acc\\xE8s, via le JS, \\xE0 l'info se trouvant dans le cookie.\"), mdx(\"p\", null, \"Quand nous g\\xE9rons une session via des cookies, il n'est pas \\xE9vident de bien cl\\xF4re une session. Nous avons cr\\xE9\\xE9 une nouvelle op\\xE9ration de type \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"GET /auths/logout\"), \" qui permet d'effacer les donn\\xE9es de session d'un utilisateur.\"), mdx(\"p\", null, \"Il nous reste \\xE0 changer le m\\xE9canisme d'autorisation.\\nLes tokens ne seront plus re\\xE7u via un authorization header, mais via un cookie.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Nous allons donc mettre \\xE0 jour le middleware \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/utils/authorize\"), \" (1 seule ligne) :\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\",\n    \"metastring\": \"numbered {7}\",\n    \"numbered\": true,\n    \"{7}\": true\n  }, \"const jwt = require('jsonwebtoken');\\nconst { readOneUserFromUsername } = require('../models/users');\\n\\nconst jwtSecret = 'ilovemypizza!';\\n\\nconst authorize = (req, res, next) => {\\n  const { token } = req.session;\\n  if (!token) return res.sendStatus(401);\\n\\n  try {\\n    const decoded = jwt.verify(token, jwtSecret);\\n    console.log('decoded', decoded);\\n    const { username } = decoded;\\n\\n    const existingUser = readOneUserFromUsername(username);\\n\\n    if (!existingUser) return res.sendStatus(401);\\n\\n    req.user = existingUser; // request.user object is available in all other middleware functions\\n    return next();\\n  } catch (err) {\\n    console.error('authorize: ', err);\\n    return res.sendStatus(401);\\n  }\\n};\\n\\nconst isAdmin = (req, res, next) => {\\n  const { username } = req.user;\\n\\n  if (username !== 'admin') return res.sendStatus(403);\\n  return next();\\n};\\n\\nmodule.exports = { authorize, isAdmin };\\n\")), mdx(\"h4\", null, \"Test de la RESTful API via REST Client\"), mdx(\"p\", null, \"Il nous reste \\xE0 tester nos requ\\xEAtes via REST Client.\"), mdx(\"p\", null, \"Il n'y a pas de nouvelles notions \\xE0 apprendre pour utiliser REST Client avec des cookies : le comportement par d\\xE9faut de REST Client est, lorsqu'un cookie est renvoy\\xE9 dans une r\\xE9ponse, c'est d'inclure ce cookie dans chaque requ\\xEAte vers la m\\xEAme origine.\"), mdx(\"p\", null, \"D\\xE8s lors, pour tester l'API, il suffit d'enlever tous les authorization headers et de rajouter une requ\\xEAte pour tester l'effacement d'une session.\"), mdx(\"p\", null, \"Veuillez tester les requ\\xEAtes \\xE0 l'aide de \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/REST Client/pizzas.http\"), \" :\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\",\n    \"metastring\": \"numbered {17,19,33,35,38-42,44-47}\",\n    \"numbered\": true,\n    \"{17,19,33,35,38-42,44-47}\": true\n  }, \"const express = require('express');\\nconst { register, login } = require('../models/users');\\n\\nconst router = express.Router();\\n\\n/* Register a user */\\nrouter.post('/register', async (req, res) => {\\n  const username = req?.body?.username?.length !== 0 ? req.body.username : undefined;\\n  const password = req?.body?.password?.length !== 0 ? req.body.password : undefined;\\n\\n  if (!username || !password) return res.sendStatus(400); // 400 Bad Request\\n\\n  const authenticatedUser = await register(username, password);\\n\\n  if (!authenticatedUser) return res.sendStatus(409); // 409 Conflict\\n\\n  createCookieSessionData(req, authenticatedUser);\\n\\n  return res.json({ username: authenticatedUser.username });\\n});\\n\\n/* Login a user */\\nrouter.post('/login', async (req, res) => {\\n  const username = req?.body?.username?.length !== 0 ? req.body.username : undefined;\\n  const password = req?.body?.password?.length !== 0 ? req.body.password : undefined;\\n\\n  if (!username || !password) return res.sendStatus(400); // 400 Bad Reques\\n\\n  const authenticatedUser = await login(username, password);\\n\\n  if (!authenticatedUser) return res.sendStatus(401); // 401 Unauthorized\\n\\n  createCookieSessionData(req, authenticatedUser);\\n\\n  return res.json({ username: authenticatedUser.username });\\n});\\n\\n/* Logout a user */\\nrouter.get('/logout', (req, res) => {\\n  req.session = null;\\n  return res.sendStatus();\\n});\\n\\nfunction createCookieSessionData(req, authenticatedUser) {\\n  req.session.username = authenticatedUser.username;\\n  req.session.token = authenticatedUser.token;\\n}\\n\\nmodule.exports = router;\\n\")), mdx(\"p\", null, \"Dans le code ci-dessus, nous pr\\xE9parons les donn\\xE9es de session qui seront \\xE9crites dans le cookie \\xE0 l'aide de l'objet \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"req.session\"), \".\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Lorsque nous renvoyons du JSON aux clients, nous ne renvoyons plus le token, mais juste le username de l'utilisateur. L'application cliente, le browser, pourra utiliser cette info pour afficher le nom de l'utilisateur. Pour rappel, le browser n'a pas acc\\xE8s, via le JS, \\xE0 l'info se trouvant dans le cookie.\"), mdx(\"p\", null, \"Quand nous g\\xE9rons une session via des cookies, il n'est pas \\xE9vident de bien cl\\xF4re une session. Nous avons cr\\xE9\\xE9 une nouvelle op\\xE9ration de type \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"GET /auths/logout\"), \" qui permet d'effacer les donn\\xE9es de session d'un utilisateur.\"), mdx(\"p\", null, \"Il nous reste \\xE0 changer le m\\xE9canisme d'autorisation.\\nLes tokens ne seront plus re\\xE7u via un authorization header, mais via un cookie.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Nous allons donc mettre \\xE0 jour le middleware \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/utils/authorize\"), \" (1 seule ligne) :\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-http\"\n  }, \"######### NORMAL OPERATION  ###########\\n\\n### Read all pizzas\\nGET http://localhost:3000/pizzas\\n\\n### Read all pizzas with File variable\\n@baseUrl = http://localhost:3000\\nGET {{baseUrl}}/pizzas\\n\\n### Read all pizzas sorted by title (ascending)\\nGET {{baseUrl}}/pizzas/?order=+title\\n\\n### Read all pizzas sorted by title (descending)\\nGET {{baseUrl}}/pizzas/?order=-title\\n\\n### Read pizza identified by 2\\nGET {{baseUrl}}/pizzas/2\\n\\n### Create a pizza by using the admin account\\n#### First login as the admin\\nPOST {{baseUrl}}/auths/login\\nContent-Type: application/json\\n\\n{\\n    \\\"username\\\":\\\"admin\\\",\\n    \\\"password\\\":\\\"admin\\\"\\n}\\n\\n#### Create a pizza with the admin token\\nPOST {{baseUrl}}/pizzas\\nContent-Type: application/json\\n\\n{\\n    \\\"title\\\":\\\"Magic Green\\\",\\n    \\\"content\\\":\\\"Epinards, Brocolis, Olives vertes, Basilic\\\"\\n}\\n\\n### Delete pizza identified by 2 with the admin token\\nDELETE {{baseUrl}}/pizzas/2\\n\\n### Update the pizza identified by 6 with the admin token\\nPATCH {{baseUrl}}/pizzas/6\\nContent-Type: application/json\\n\\n{\\n    \\\"title\\\":\\\"Magic Green 2\\\"\\n}\\n\\n\\n######### ERROR OPERATION  ###########\\n\\n### 1. Create a pizza without a token\\nPOST {{baseUrl}}/pizzas\\nContent-Type: application/json\\n\\n{\\n    \\\"title\\\":\\\"Magic Green\\\",\\n    \\\"content\\\":\\\"Epinards, Brocolis, Olives vertes, Basilic\\\"\\n}\\n\\n### 2. Create a pizza without being the admin, use manager account\\n#### 2.1 First login as the manager\\nPOST {{baseUrl}}/auths/login\\nContent-Type: application/json\\n\\n{\\n    \\\"username\\\":\\\"manager\\\",\\n    \\\"password\\\":\\\"manager\\\"\\n}\\n\\n#### 2.2 Try to create a pizza with the manager token\\nPOST {{baseUrl}}/pizzas\\nContent-Type: application/json\\n\\n{\\n    \\\"title\\\":\\\"Magic Green\\\",\\n    \\\"content\\\":\\\"Epinards, Brocolis, Olives vertes, Basilic\\\"\\n}\\n\\n### Read pizza which does not exists\\nGET {{baseUrl}}/pizzas/100\\n\\n### Create a pizza which lacks a property\\nPOST {{baseUrl}}/pizzas\\nContent-Type: application/json\\n\\n{\\n    \\\"content\\\":\\\"Epinards, Brocolis, Olives vertes, Basilic\\\"\\n}\\n\\n### Create a pizza without info for a property\\nPOST {{baseUrl}}/pizzas\\nContent-Type: application/json\\n\\n{\\n    \\\"title\\\":\\\"\\\",\\n    \\\"content\\\":\\\"Epinards, Brocolis, Olives vertes, Basilic\\\"\\n}\\n\\n### Update for a pizza which does not exist\\nPATCH {{baseUrl}}/pizzas/200\\nContent-Type: application/json\\n\\n{\\n    \\\"title\\\":\\\"Magic Green 2\\\"\\n}\\n\\n### Update for a pizza which does not provide any info for a property\\nPATCH {{baseUrl}}/pizzas/1\\n\\nContent-Type: application/json\\n\\n{\\n    \\\"title\\\":\\\"Magic Green 2\\\",\\n    \\\"content\\\":\\\"\\\"\\n}\\n\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/REST Client/auths.http\"), \" a \\xE9t\\xE9 mis \\xE0 jour pour tester \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"GET /auths/logout\"), \" :\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-http\"\n  }, \"### Logout any user\\nGET {{baseUrl}}/auths/logout\\n\")), mdx(\"p\", null, \"Pour ajouter une pizza, il suffit juste :\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"De loguer l'admin.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"De cr\\xE9er une nouvelle pizza ; le cookie est automatiquement envoy\\xE9.\")), mdx(\"p\", null, \"Admettons que vous souhaitez tester l'ajout d'une pizza sans envoyer de token :\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Lancer l'op\\xE9ration de logout (GET /auths/logout) ; le cookie renvoy\\xE9 ne contient pas de donn\\xE9es de session ;\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Tentez la cr\\xE9ation d'une pizza qui renverra un code 401 Unauthorized.\")), mdx(\"p\", null, \"Si tout fonctionne bien, faites un \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"commit\"), \" de votre repo (\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"web2\"), \") avec le message\\n\\\"\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"cookies api\"), \"\\\".\"), mdx(\"p\", null, \"En cas de souci, vous pouvez utiliser le code du tutoriel \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/cookies\"\n  }, \"cookies\"), \".\"), mdx(\"h3\", null, \"Gestion de session c\\xF4t\\xE9 client via une IHM et des cookies\"), mdx(\"p\", null, \"A pr\\xE9sent que notre API \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"cookies\"), \" renvoie les donn\\xE9es de session dans un cookie non accessible par du JS, nous souhaitons mettre \\xE0 jour notre IHM pour utiliser cette API.\"), mdx(\"p\", null, \"Nous allons repartir de la derni\\xE8re version de notre frontend.\"), mdx(\"p\", null, \"Au sein de votre repo \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"web2\"), \", veuillez cr\\xE9er le projet nomm\\xE9 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/web2/tutorials/pizzeria/hmi/cookies\"), \" sur base d'un copi\\xE9 coll\\xE9 de \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/web2/tutorials/pizzeria/hmi/web-storage\"), \" (ou \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/e-vinci/js-demos/tree/main/frontend/frontend-essentials/web-storage\"\n  }, \"web-storage\"), \").\"), mdx(\"p\", null, \"Pour la suite du tutoriel, nous consid\\xE9rons que tous les chemins absolus d\\xE9marrent du r\\xE9pertoire\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/web2/tutorials/pizzeria/hmi/cookies\"), \".\"), mdx(\"p\", null, \"Afin de sauvegarder les donn\\xE9es de session, c'est \\xE0 dire l'objet \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"authenticatedUser\"), \" contenant juste un username, nous ne devons m\\xEAme pas mettre \\xE0 jour le fichier \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/usr/utils/auths.js\"), \". En effet, l'API \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"cookies\"), \" renvoie un objet du genre \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"{username: \\\"manager\\\"}\"), \". Au niveau de l'IHM, le code est donc toujours fonctionnel pour sauvegarder le username gr\\xE2ce \\xE0 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"authenticatedUser\"), \".\"), mdx(\"p\", null, \"Il ne reste donc qu'\\xE0 changer le code o\\xF9 nous avons besoin d'une autorisation. Pour l'application de gestion de la pizzeria, il s'agit de la cr\\xE9ation de pizza.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Veuillez donc mettre \\xE0 jour \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/src/Components/AddPizzaPage.js\"), \" en enlevant ces deux lignes :\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"l'authenticatedUser : \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"const authenticatedUser = getAuthenticatedUser();\"), \" et l'import associ\\xE9 (\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"import { getAuthenticatedUser } from '../../utils/auths';\"), \"),\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"la ligne s'occupant de l'authorization header : \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Authorization: authenticatedUser.token\"), \".\")), mdx(\"p\", null, \"Veuillez tester votre derni\\xE8re version du frontend.\\nLoguez-vous avec l'utilisateur \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"admin\"), \" (et le password \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"admin\"), \").\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Ajoutez une pizza et v\\xE9rifiez qu'elle s'affiche bien.  \"), mdx(\"p\", null, \"\\uD83D\\uDCAD Comment v\\xE9rifier le cookie ?\\nTout en ayant la fen\\xEAtre de votre application ouverte, via Chrome, allez dans vos outils de d\\xE9veloppeurs : \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"F12\"), \".\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Puis, dans l'onglet \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Application\"), \", cliquez sur \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Cookies\"), \", vous verrez appara\\xEEtre \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://localhost:8080\"), \". Cliquez sur cette URL, et vous verrez vos 2 cookies de session, \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"user.sig\"), \" et \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"user\"), \".\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"N'h\\xE9sitez pas \\xE0 aller d\\xE9coder la valeur du cookie \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"user\"), \" sur \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.base64decode.org/\"\n  }, \"base64decode\"), \" en faisant un copier / coller de \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Value\"), \". Vous devriez voir quelque chose appara\\xEEtre du style \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"{\\\"username\\\":\\\"manager\\\",\\\"token\\\":\\\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Im1hbmFnZXIiLCJpYXQiOjE2NjE3NzUxMDgsImV4cCI6MTc0ODE3NTEwOH0.sAZqq6vbrjCCZZoLH-n8hJKBoXJJJ8jEoupk8xKu5WI\\\"}\"), \"  !\"), mdx(\"p\", null, \"Toujours dans l'onglet \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Application\"), \" des outils de d\\xE9veloppeurs de Chrome, faites un clear des cookies : clic droit sur \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://localhost:8080\"), \", \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Clear\"), \".\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Tentez maintenant d'ajouter une pizza... Ca ne fonctionne plus, et c'est bien normal, car il n'y a plus de token qui est envoy\\xE9 \\xE0 l'API !  \"), mdx(\"p\", null, \"Suite \\xE0 ces tests, si tout fonctionne bien, faites un \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"commit\"), \" de votre repo (\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"web2\"), \") avec le message \\\"\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"cookies hmi\"), \"\\\".\"), mdx(\"p\", null, \"En cas de souci, vous pouvez utiliser le code du tutoriel :\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"pour le frontend : \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/e-vinci/js-demos/tree/main/frontend/frontend-essentials/cookies\"\n  }, \"cookies\"), \".\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"pour l'API : \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/cookies\"\n  }, \"cookies\"), \".\")), mdx(\"p\", null, \"\\uD83D\\uDCAD Notons que cette version de notre frontend pourrait \\xEAtre am\\xE9lior\\xE9e. Actuellement, lorsqu'on fait un logout, on n'efface pas le cookie du browser.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Comment feriez vous ? Vous pourriez par exemple appeler la m\\xE9thode \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"GET /auths/logout\"), \" \\uD83D\\uDE09.\"), mdx(\"h1\", null, mdx(\"a\", {\n    id: \"b\"\n  }), \" b) Exercice 8.1 : Persistance de la session de myMovies dans le web storage\"), mdx(\"p\", null, \"Lors de l'exercice pr\\xE9c\\xE9dent (Exercice 7.2), vous aviez une application qui permet de bien g\\xE9rer des films, \\xE0 l'exception du fait que quand vous fermez votre browser, vous devez \\xE0 chaque fois vous reconnecter.\"), mdx(\"p\", null, \"Veuillez faire en sorte que vos donn\\xE9es de session soient sauvegard\\xE9es :\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"dans le \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"localStorage\"), \" si l'on clique sur une checkbox \\\"Remember me\\\" du login ou du register.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"dans le \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"sessionStorage\"), \" si l'on ne clique pas sur la checkbox \\\"Remember me\\\" lors du login ou du register.\")), mdx(\"p\", null, \"Afin de r\\xE9aliser cet exercice, voici les contraintes d'impl\\xE9mentation :\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Veuillez d\\xE9marrer votre API d\\xE9velopp\\xE9e pr\\xE9c\\xE9demment : \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"/exercises/module7/7.2/api\"), \".\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Pour le frontend, utilisez le contenu de votre r\\xE9pertoire d'exercices \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"/exercises/module7/7.1/hmi\"), \" comme point de d\\xE9part pour cr\\xE9er, dans votre repository local et\\nvotre web repository (normalement appel\\xE9 \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"web2\"), \"), le r\\xE9pertoire nomm\\xE9\\n\", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"/exercises/module8/8.1/hmi\"), \".\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Veuillez utiliser le proxy de votre frontend afin de contourner les probl\\xE8mes associ\\xE9 \\xE0 la gestion des CORS.\")), mdx(\"h4\", null, \"\\uD83E\\uDD1D Tips\"), mdx(\"p\", null, \"Cet exercice est l'application du tutoriel vu dans ce module-ci. N'h\\xE9sitez pas donc \\xE0 rejouer les \\xE9tapes vues dans le tutoriel au niveau de votre API : \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"#a2\"\n  }, \"a.2) Persistance de donn\\xE9es de sessions via le web storage\"), \".\"), mdx(\"p\", null, \"Vous allez aussi pouvoir refaire un petit peu de gestion d'\\xE9v\\xE9nements pour d\\xE9tecter les clics sur une checkbox.\"), mdx(\"p\", null, \"Veuillez faire un \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"commit\"), \" de votre code avec le message suivant :\\n\\\"\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"myMovies : module 8 : web storage\"), \"\\\"\\\".\"), mdx(\"p\", null, \"NB : Le code de vos applications se trouve dans votre repository local et\\nvotre web repository (normalement appel\\xE9 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"web2\"), \") dans le r\\xE9pertoire nomm\\xE9\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/exercises/module8/8.1/hmi\"), \".\"), mdx(\"h1\", null, mdx(\"a\", {\n    id: \"c\"\n  }), \" c) D\\xE9ploiement d'applications sur le cloud\"), mdx(\"h2\", null, mdx(\"a\", {\n    id: \"c1\"\n  }), \" c.1) Introduction\"), mdx(\"p\", null, \"Il existe \\xE9norm\\xE9ment de possibilit\\xE9s pour d\\xE9ployer une application web, pour la rendre disponible sur le web.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Pour certains, il s'agit d'un m\\xE9tier \\xE0 part enti\\xE8re, \\xE0 des administrateurs r\\xE9seaux ou des responsables de l'architecture.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Mais de plus en plus, avec l'avanc\\xE9e des services sur le cloud, les d\\xE9veloppeurs prennent un r\\xF4le important dans le d\\xE9ploiement des applications.\"), mdx(\"p\", null, \"Voici un diagramme qui exprime bien les diff\\xE9rentes fa\\xE7ons de d\\xE9ployer une applications :\"), mdx(ScrollableImage, {\n    name: \"deployment.png\",\n    minWidth: \"600px\",\n    maxWidth: \"881x\",\n    mdxType: \"ScrollableImage\"\n  }), mdx(\"figcaption\", null, \"Diff\\xE9rents types de d\\xE9ploiement d'application [R.65]\"), mdx(\"p\", null, \"Sur ce diagramme, tout \\xE0 gauche, nous sommes enti\\xE8rement responsable de la mise \\xE0 disposition de l'infrastructure. Il faut donc d'\\xE9normes connaissances r\\xE9seaux, au niveau OS, afin de mettre \\xE0 disposition des serveurs, les s\\xE9curiser,...\"), mdx(\"p\", null, \"Lorsqu'on va vers la droite du diagramme, on passe vers la d\\xE9mat\\xE9rialisation des services, vers le cloud, qui offre principalement trois types de services :\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"IaaS\"), \" ou Infrastructure as a Service : nous recevons toute l'infrastructure, nous devons encore nous occuper du reste, la gestion d'un OS (Linux, Windows...), les bases de donn\\xE9es, les applications et leurs donn\\xE9es ; Amazon Web Services, Microsoft Azure, Google Cloud, OVHcloud offrent ce genre de services...\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"PaaS\"), \" ou Platform as a Service : nous recevons tout ce qu'il faut pour simplement d\\xE9velopper des applications ; heroku, Amazon Web Services, Microsoft Azure, Google Cloud, OVHcloud offrent ce genre de services...\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"SaaS\"), \" ou Software as a Service : nous recevons des applications pr\\xEAtes \\xE0 \\xEAtre utilis\\xE9es ; office 365 est un exemple, Github en est un autre.\")), mdx(\"p\", null, \"Lorsque nous allons d\\xE9ployer nos RESTful API, nous allons donc tr\\xE8s souvent utiliser un \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"PaaS\"), \". En effet, voici les \\xE9tapes principales pour le d\\xE9ploiement :\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"cr\\xE9er et configurer le type d'application que nous allons d\\xE9ployer avec les outils offerts par le provider : indiquer que nous souhaitons d\\xE9velopper une application \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Node.js\"), \" ;\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"cr\\xE9er un git repository pour chaque projet et faire un push des sources de notre application via les outils offerts par le provider ;\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"build et d\\xE9ploiement automatique de l'application faits par les outils du provider, sur une URL de d\\xE9veloppement offerte par le provider.\")), mdx(\"p\", null, \"Chaque provider va fournir une recette de cuisine pour pouvoir d\\xE9ployer une application. Il est donc important de trouver la bonne documentation d\\xE9crivant toutes les \\xE9tapes.\"), mdx(\"p\", null, \"Pour d\\xE9ployer le frontend d'une SPA, les \\xE9tapes principales sont similaires au d\\xE9ploiement d'une RESTful API. N\\xE9anmoins, il existe des outils qui permettent de faciliter le d\\xE9ploiement du frontend d'une SPA car ce sont juste des assets \\xE0 partager sur le web, il n'y a pas d'intelligence \\xE0 fournir c\\xF4t\\xE9 serveur pour g\\xE9n\\xE9rer du contenu.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Du coup, on peut utiliser des CDN (Content Delivery Network), des groupes de serveur qui travaillent ensemble pour fournir nos assets de mani\\xE8re extra rapide sur Internet.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Comme Github offre ce service via \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Github Pages\"), \", que c'est gratuit si vous acceptez que votre code source soit publique, c'est un service id\\xE9al pour notre frontend.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Il faut juste faire attention que votre frontend n'utilise pas de proxy pour contacter votre RESTful API, il doit le faire directement. L'API devra donc g\\xE9rer les CORS pour autoriser l'URL associ\\xE9e \\xE0 votre frontend !\"), mdx(\"p\", null, \"Pour d\\xE9ployer nos RESTful API, le facteur principal que nous souhaitons mettre en avant dans ce cours, c'est de b\\xE9n\\xE9ficier d'un service gratuit. Comme nous \\xE9tudions le JS, nous consid\\xE9rons que nous n'avons pas encore besoin d'un h\\xE9bergement offrant de grandes performances. Nous souhaitons juste quelque chose qui nous permette de tester, sur le web, nos applications web, et les partager avec quelques dizaines de personnes. Pour le frontend, via \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Github Pages\"), \", nous avons trouv\\xE9 un service de qualit\\xE9, partageable avec des milliers de personnes. Par contre, pour h\\xE9berger une API, les services gratuits tendent \\xE0 dispara\\xEEtre.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Avant l'automne 2022, \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Heroku\"), \" fournissait un service gratuit qui \\xE9tait parfait pour nos API. Mais ce service va dispara\\xEEtre. Il y a un petit espoir qu'Heroku mette un \\\"Student Program\\\" en place, mais rien de s\\xFBr.\"), mdx(\"p\", null, \"Du coup, pour construire une API, il semblerait qu'il ne reste plus que des services qui soient que temporairement gratuits. Le souci avec ce genre de services, c'est que m\\xEAme si c'est gratuit, on vous demande votre carte de cr\\xE9dit, afin de \\\"v\\xE9rifier que vous n'\\xEAtes pas un robot\\\" \\uD83E\\uDD16 !\"), mdx(\"p\", null, \"Nous avons donc tent\\xE9 de s\\xE9lectionner un service gratuit, temporaire, qui ne demande pas de carte de cr\\xE9dit.\"), mdx(\"h2\", null, mdx(\"a\", {\n    id: \"c2\"\n  }), \" c.2) D\\xE9ploiement du frontend sur GitHub Pages\"), mdx(\"p\", null, \"Si vous n'utilisez pas de proxy dans votre frontend mais que vous faites des requ\\xEAtes vers votre RESTful API en utilisant directement son nom de domaine, il est tr\\xE8s simple d'utiliser \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Github Pages\"), \". \"), mdx(\"p\", null, \"Votre RESTful API doit donc elle aussi \\xEAtre d\\xE9ploy\\xE9e et vous devez utiliser son URL pour tous les fetch que vous faites. Pensez donc \\xE0 centraliser la configuration de l'URL associ\\xE9e \\xE0 votre API au sein du code de votre frontend.\"), mdx(\"p\", null, \"Vous trouverez la recette de cuisine pour d\\xE9ployer votre frontend sur \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://pages.github.com/\"\n  }, \"GitHub Pages\"), \".\"), mdx(\"h2\", null, mdx(\"a\", {\n    id: \"c3\"\n  }), \" c.3) D\\xE9ploiement d'une API sur Heroku\"), mdx(\"h3\", null, \"c.3.1) Introduction\"), mdx(\"p\", null, \"D\\xE8s le 28 novembre 2022, les \\\"free Heroku Dynos\\\" ne seront plus disponibles.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Il y a malgr\\xE9 tout un espoir que pour les \\xE9tudiants, un programme soit mis \\xE0 disposition. L'info sera rendue disponible en fin septembre : \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://blog.heroku.com/next-chapter\"\n  }, \"Heroku\\\"s Next Chapter\"), \".\"), mdx(\"h3\", null, \"c.3.2) Proc\\xE9dure \\\"maison\\\"\"), mdx(\"p\", null, \"Sur le site d'Heroku, il existe beaucoup de documentation pour apprendre \\xE0 d\\xE9ployer \\xE0 l'aide de leurs outils.\"), mdx(\"p\", null, \"Comme il n'est pas si facile de s'y retrouver, voici ci-dessous un r\\xE9sum\\xE9 des \\xE9tapes importantes via une proc\\xE9dure \\\"maison\\\".\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Pr\\xE9paration de votre application\")), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Utilisez les bonnes variables d'environnement dans Node.js en v\\xE9rifiant que \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"strong\"\n  }, \"process.env.PORT\")), \" est bien \\xE9crit dans \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"/bin/www\"), \".\", mdx(\"br\", {\n    parentName: \"li\"\n  }), mdx(\"em\", {\n    parentName: \"li\"\n  }, \"La variable d'environnement \", mdx(\"inlineCode\", {\n    parentName: \"em\"\n  }, \"PORT\"), \", accessible sous Node via \", mdx(\"inlineCode\", {\n    parentName: \"em\"\n  }, \"process.env.PORT\"), \" , est allou\\xE9 par Heroku lors du d\\xE9marrage de l'application. Pour \", mdx(\"inlineCode\", {\n    parentName: \"em\"\n  }, \"HOST\"), \", le plus simple est de ne pas en avoir : votre serveur \\xE9coute sur toutes les IP. C'est ce qui est fait par d\\xE9faut lorsqu'une application Express est g\\xE9n\\xE9r\\xE9e.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"V\\xE9rifiez \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"strong\"\n  }, \"package.json\")), \" : Le script \\\"start\\\" sera ce que heroku lance en 1er.\", mdx(\"br\", {\n    parentName: \"li\"\n  }), mdx(\"em\", {\n    parentName: \"li\"\n  }, \"Il n'y a normalement rien \\xE0 faire, \", mdx(\"inlineCode\", {\n    parentName: \"em\"\n  }, \"package.json\"), \" doit contenir pour \\\"start\\\" :\"))), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"\\\"scripts\\\": {\\n\\\"start\\\": \\\"node ./bin/www\\\" },\\n\")), mdx(\"ol\", {\n    \"start\": 3\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Cr\\xE9ez un nouvelle app sur Heroku en vous rendant sur \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://www.heroku.com/\"\n  }, \"HEROKU\"), \", \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Sign up\"), \" puis via le \\\"Heroku dashboard\\\" : \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"New\"), \", \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Create\"), \", \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"New app\"), \".\", mdx(\"br\", {\n    parentName: \"li\"\n  }), mdx(\"em\", {\n    parentName: \"li\"\n  }, \"Donnez un nom \\xE0 votre Heroku app qui soit associ\\xE9 \\xE0 votre API.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Installez le heroku buildpack pour node ; via le \\\"Heroku dashboard\\\", \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Settings\"), \", \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Add buildpacks\"), \", \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"nodejs\"), \".\", mdx(\"br\", {\n    parentName: \"li\"\n  }), mdx(\"em\", {\n    parentName: \"li\"\n  }, \"L'URL g\\xE9n\\xE9r\\xE9e pour le buildpack est \\\"heroku/nodejs\\\".\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Configurez vos variables d'environnement au sein d'Heroku.\", mdx(\"br\", {\n    parentName: \"li\"\n  }), mdx(\"em\", {\n    parentName: \"li\"\n  }, \"Si vous n'avez pas de secrets au niveau de votre API, pas de base de donn\\xE9es ou autres services, vous n'avez rien \\xE0 faire \\xE0 cette \\xE9tape-ci. Sinon, voici la documentation : \", mdx(\"a\", {\n    parentName: \"em\",\n    \"href\": \"https://devcenter.heroku.com/articles/config-vars\"\n  }, \"Configuration and Config Vars\"), \".\"))), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Push de votre application sur Heroku \\xE0 l'aide de votre git local\")), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Allez dans le repo de votre application\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Ajoutez une remote vers le repo de votre Heroku app :\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Option a) avec heroku CLI : \")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"npm install -g heroku\\nheroku login\\nheroku git:remote -a [your_app_name]\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Option b) sans heroku CLI, directement avec Git : \")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"git remote add heroku https://git.heroku.com/[your_app_name].git\\n\")), mdx(\"ol\", {\n    \"start\": 3\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Faites un push de la branche en cours vers le master sur Heroku :\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"git push heroku master\\n\")), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Si votre branche en cours n'est pas le master :\"), \" \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"git push heroku [branche_en_cours]:master [-f]\\n\")), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"-f si la branche locale est fort diff\\xE9rente du contenu sur Heroku.\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Acc\\xE8s \\xE0 votre API via le browser\")), mdx(\"p\", null, \"Soit \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Open app\"), \" via \\\"Heroku dashboard\\\", soit vous pouvez directement taper dans le browser : \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"[your_app_name.herokuapp.com\"), \".\"), mdx(\"h2\", null, mdx(\"a\", {\n    id: \"c4\"\n  }), \" c.4) D\\xE9ploiement d'une API sur des providers gratuits\"), mdx(\"p\", null, \"Voici une liste de providers qui pourraient \\xEAtre int\\xE9ressants pour vos d\\xE9ploiements :\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://azure.microsoft.com/en-us/free/\"\n  }, \"Microsoft Azure\"), \" : \", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Vous \\xEAtes \\xE9tudiant ? Il semblerait que vous puissiez b\\xE9n\\xE9ficier de 100$ de cr\\xE9dit et vous n'avez pas besoin de carte de cr\\xE9dit ! Rendez-vous sur \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://azure.microsoft.com/en-in/free/students/\"\n  }, \"free with Azure for Student\"), \". \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Azure App Service\"), \" semble \\xEAtre gratuit pour 10 apps \\xE0 vie !\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Vous n'\\xEAtes plus \\xE9tudiant ? services gratuits, certains toujours gratuits, d'autres pendant 12 mois, 200$ de cr\\xE9dit pendant 30 jours. Malheureusement il faut une carte de cr\\xE9dit pour vous faire autoriser... \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Azure App Service\"), \" semble \\xEAtre gratuit pour 10 apps \\xE0 vie ! \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://docs.microsoft.com/en-us/azure/app-service/\"\n  }, \"Documentation d'App Service\"), \" et \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://azure.microsoft.com/en-us/pricing/details/app-service/linux/\"\n  }, \"App Service pricing\"), \".\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://platform.sh/pricing/\"\n  }, \"platform.sh\"), \" : service gratuit pendant 30 jours, pas besoin de carte de cr\\xE9dit.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://cloud.google.com/pricing\"\n  }, \"Google Cloud\"), \" : service offrant 300$ de cr\\xE9dit, pendant 90 jours, il faut une carte de cr\\xE9dit \\uD83D\\uDE28, mais pas de charges sauf si upgrade manuel vers un compte payant.\")), mdx(\"h1\", null, mdx(\"a\", {\n    id: \"d\"\n  }), \" d) Exercice 8.2 : D\\xE9ploiement de myMovies sur le cloud\"), mdx(\"p\", null, \"Tout est dit dans le titre \\uD83D\\uDE09.\"), mdx(\"p\", null, \"Pour le frontend, veuillez utiliser GitHub Pages.\"), mdx(\"p\", null, \"Pour le backend, si vous \\xEAtres \\xE9tudiant, nous vous recommandons de vous inscrire sur Azure en tant que \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"student\"), \" pour obtenir vos 100$ de cr\\xE9dit, sans carte de cr\\xE9dit.\"), mdx(\"h4\", null, \"\\uD83E\\uDD1D Tips\"), mdx(\"p\", null, \"Pensez \\xE0 cr\\xE9er un repository pour votre frontend et un repository pour votre backend.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"La racine de vos repositories doivent correspondre \\xE0 la racine de vos projets. Pour vous en assurer, \\xE0 la racine de chaque repo, doit se trouver un fichier \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/packages.json\"), \".\"), mdx(\"p\", null, \"\\u26A1 Attention, Git ne traque pas les repos dans les repos. Ainsi, vos deux projets ne peuvent pas se trouver dans le repos \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"web2\"), \" de votre cours !\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"N'oubliez pas d'inclure un fichier \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \".gitignore\"), \" pour \\xE9viter de mettre en configuration \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"node_modules\"), \" !\"), mdx(\"h1\", null, mdx(\"a\", {\n    id: \"e\"\n  }), \" e) \\uD83C\\uDF6C Exercice 8.3 : D\\xE9ploiement de myMovies sur le cloud\"), mdx(\"h2\", null, \"e.1) Introduction\"), mdx(\"p\", null, \"Voici un exercice qui fait revoir les comp\\xE9tences essentiels de ce cours de JS. Il a \\xE9t\\xE9 utilis\\xE9 comme examen pour les \\xE9tudiants de Vinci en deuxi\\xE8me ann\\xE9e de bachelier en Informatique de Gestion en ao\\xFBt 2022. \"), mdx(\"p\", null, \"Normalement, cette exercice, d\\xE9coup\\xE9 en trois questions, devrait se r\\xE9aliser dans un d\\xE9lai de 3h.\"), mdx(\"p\", null, \"Veuillez t\\xE9l\\xE9charger ce fichier\"), mdx(LinkFile, {\n    name: \"examen_js.zip\",\n    target: \"_blank\",\n    download: true,\n    mdxType: \"LinkFile\"\n  }, \"examen_js.zip\"), \". Cette archive contient un boilerplate pour chaque question et les ressources \\xE0 utiliser pour cet examen.\", mdx(\"p\", null, \"Dans un premier temps, veuillez d\\xE9sarchiver \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"examen_js.zip\"), \" localement sur votre machine.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"\\u26A1 Veuillez \\xE9viter de le faire sur un r\\xE9pertoire qui est partag\\xE9 sur le cloud. En effet, il y a des milliers de fichiers associ\\xE9s aux \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"node_modules\"), \" lorsque vous lancerez l'installation des packages ! Une vraie horreur \\xE0 synchroniser \\uD83D\\uDE28 !\"), mdx(\"h2\", null, \"e.2) Objectif\"), mdx(\"p\", null, \"Nous allons d\\xE9velopper deux frontends et une API pour une agence de voyages.\"), mdx(\"h2\", null, \"e.3) Question 1 : Cr\\xE9er une IHM interactive & moderne\"), mdx(\"p\", null, \"Nous souhaitons afficher des lieux de vacances propos\\xE9s par l'agence de voyages. Il y a 5 lieux diff\\xE9rents, chacun avec un id, un nom et une image.\"), mdx(\"p\", null, \"Le boilerplate pour cette question se trouve dans \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/question1\"), \".\\nVous trouverez 5 images correspondant \\xE0 chaque lieu dans le r\\xE9pertoire \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/question1/src/img\"), \", ainsi qu'un fichier contenant une liste des lieux avec leur id, leur nom et leur image dans \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/question1/src/utils/places.js\"), \".\"), mdx(\"p\", null, \"Vous devez cr\\xE9er deux pages :\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"La page d'accueil, accessible avec l'URI \\\"/\\\" ou avec un lien nomm\\xE9 \\\"Home\\\" dans la barre de navigation, doit afficher une liste de tous les noms de lieux de vacances.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"La page de photos, accessible avec l'URI \\\"/photos\\\" ou avec un lien nomm\\xE9 \\\"Photos\\\" dans la barre de navigation, doit afficher un carrousel des lieux propos\\xE9s.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Lorsqu'on arrive sur la page initialement, la page doit afficher le 3\\xE8me lieu dans la liste, avec son image et son nom en dessous.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"La page doit \\xE9galement afficher deux boutons. Le premier permet d'afficher le lieu pr\\xE9c\\xE9dent dans la liste \\xE0 la place de celui-ci. Et  l'autre permet d'afficher le lieu suivant. Ces boutons ne doivent pas \\xEAtre cliquables s'il n'y a plus de lieu suivant ou de lieu pr\\xE9c\\xE9dent dans la liste.\")), mdx(\"p\", null, \"Contraintes d'impl\\xE9mentation : \"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Veuillez utiliser le fichier \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"/question1/src/utils/places.js\"), \" qui reprend des lieux de vacances. Vous devez mettre \\xE0 jour ce fichier pour pouvoir l'utiliser dans votre code JS comme module.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Aucune autre page ne doit \\xEAtre disponible sur le site web.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Vous devez impl\\xE9menter le carrousel vous-m\\xEAme, vous ne pouvez pas utiliser un carrousel de Bootstrap.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Utilisez les images import\\xE9es statiquement dans la liste des lieux de vacances et changez la source de l'image affich\\xE9e quand l'utilisateur clique sur un bouton.\")), mdx(\"p\", null, \"Voici un exemple de ce \\xE0 quoi pourrait ressembler votre site web :\"), mdx(ScrollableImage, {\n    name: \"places.png\",\n    minWidth: \"800px\",\n    maxWidth: \"1599x\",\n    mdxType: \"ScrollableImage\"\n  }), mdx(ScrollableImage, {\n    name: \"carousel.png\",\n    minWidth: \"800px\",\n    maxWidth: \"1599x\",\n    mdxType: \"ScrollableImage\"\n  }), mdx(\"h2\", null, \"e.4) Question 2 : Cr\\xE9er un service web\"), mdx(\"p\", null, \"Nous souhaitons d\\xE9velopper une RESTful API pour g\\xE9rer les lieux de vacances propos\\xE9s par l'agence, les utilisateurs du site, ainsi que les lieux favoris de ces utilisateurs.\"), mdx(\"p\", null, \"Le boilerplate pour l'API de cette question se trouve dans \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/question2\"), \", c'est une copie du boilerplate du cours.\"), mdx(\"p\", null, \"Veuillez cr\\xE9er les op\\xE9rations suivantes :\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Cr\\xE9er un nouveau lieu de vacances\"), \". L'op\\xE9ration doit prendre en entr\\xE9e le nom du lieu ainsi que sa description, et doit retourner l'ID du lieu cr\\xE9\\xE9 au format JSON. L'op\\xE9ration doit renvoyer une erreur si le nom ou la description ne sont pas fournis.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Cr\\xE9er un nouvel utilisateur\"), \". L'op\\xE9ration doit prendre en entr\\xE9e le nom de l'utilisateur ainsi que son adresse mail, et doit retourner l'ID de l'utilisateur cr\\xE9\\xE9 au format JSON. L'op\\xE9ration doit renvoyer une erreur si le nom ou l'adresse mail ne sont pas fournis, ainsi que si un utilisateur existe d\\xE9j\\xE0 pour cette adresse mail.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Ajouter un lieu \\xE0 ses favoris\"), \". L'op\\xE9ration doit prendre en entr\\xE9e l'ID de l'utilisateur et l'ID du lieu qu'il souhaite ajouter en favori. L'op\\xE9ration doit renvoyer une erreur si aucun utilisateur ne correspond \\xE0 l'ID d'utilisateur donn\\xE9, si aucun lieu ne correspond \\xE0 l'ID de lieu donn\\xE9, ou si cet utilisateur a d\\xE9j\\xE0 ce lieu dans ses favoris.\")), mdx(\"p\", null, \"Vous devez \\xE9galement cr\\xE9er dans le fichier \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/question2/RESTClient/tests.http\"), \" au minimum une requ\\xEAte par op\\xE9ration que vous devez impl\\xE9menter. Vous pouvez \\xE9galement cr\\xE9er plus de tests si vous le souhaitez.\"), mdx(\"p\", null, \"Contraintes d'impl\\xE9mentation :\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"L'API que vous devez cr\\xE9er doit correspondre aux principes d'une API RESTful.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Votre API ne peut pas proposer d'autres op\\xE9rations que celles d\\xE9crites ci-dessus.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Les ID que g\\xE9n\\xE8rent votre API doivent provenir du package \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"uuid\"), \".\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Les demandes qui sont cr\\xE9\\xE9es doivent persister et donc survivre au red\\xE9marrage de votre application. Vous pouvez faire persister les demandes c\\xF4t\\xE9 serveur de la mani\\xE8re que vous voulez, du moment que cela soit en JSON. N'h\\xE9sitez pas \\xE0 utiliser \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"/question2/utils/json.js\"), \".\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Aucune autorisation JWT est n\\xE9cessaire.\")), mdx(\"h2\", null, \"e.5) Question 3 : Cr\\xE9er une SPA int\\xE9grant une IHM et un web service\"), mdx(\"p\", null, \"Gr\\xE2ce \\xE0 l'API que nous avez d\\xE9velopp\\xE9 dans la question 2, l'agence de voyages a pu am\\xE9liorer son API pour proposer un syst\\xE8me de recommandations. Cependant, cette API utilise un syst\\xE8me d'Intelligence Artificielle complexe et les op\\xE9rations qui r\\xE9cup\\xE8rent les recommandations peuvent prendre un certain temps. \"), mdx(\"p\", null, \"Le boilerplate pour cette question se trouve dans \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"/question3\"), \".\\nVous devez consommer l'API d\\xE9crite ci-dessous et disponible \\xE0 l'adresse \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://binv2150-aout2022.herokuapp.com\"\n  }, \"https://binv2150-aout2022.herokuapp.com\"), \" pour afficher des recommandations de lieux de vacances. Cette API accepte les requ\\xEAtes venant de toutes les origines et n'a pas de probl\\xE8me de CORS. Vous ne devez donc pas utiliser de proxy pour consommer cette API.\"), mdx(\"table\", null, mdx(\"thead\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"thead\"\n  }, mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"M\\xE9thode HTTP\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"URI\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Op\\xE9ration\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Format\"))), mdx(\"tbody\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"strong\", {\n    parentName: \"td\"\n  }, \"GET\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"strong\", {\n    parentName: \"td\"\n  }, \"/places\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"R\\xE9cup\\xE9rer tous les lieux de vacances\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Renvoie : \", mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"[ { id, name } ]\"))), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"strong\", {\n    parentName: \"td\"\n  }, \"GET\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"strong\", {\n    parentName: \"td\"\n  }, \"/recommended\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"R\\xE9cup\\xE9rer le lieu de vacances le plus appr\\xE9ci\\xE9\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Renvoie : \", mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"{ id, name }\"))))), mdx(\"p\", null, \"Sur la page d'accueil du site web, veuillez afficher le nom de tous les lieux de vacances, renvoy\\xE9s par l'API avec l'URI \\\"/places\\\" (il n'est pas n\\xE9cessaire d'afficher leur ID). \"), mdx(\"p\", null, \"Toujours sur la page d'accueil, veuillez \\xE9galement afficher le nom du lieu de vacances le plus appr\\xE9ci\\xE9, renvoy\\xE9 par l'API avec l'URI \\\"/recommended\\\". Comme cette op\\xE9ration peut prendre un certain temps, elle ne peut pas ralentir le chargement de la page. Le reste de la page doit \\xEAtre affich\\xE9 avant de consommer cette API, et son r\\xE9sultat doit \\xEAtre rajout\\xE9 sur la page quand l'op\\xE9ration est termin\\xE9e.\"), mdx(\"p\", null, \"Aucune autre page ne doit \\xEAtre disponible sur le site web. Pensez donc \\xE0 effacer le code du boilerplate qui est inutile.\"));\n}\n;\nMDXContent.isMDXComponent = true;","slug":"modules/8.fr","frontmatter":{"title":"Module 8 : SPA & sessions & déploiement","date":null,"navbarExtraStyles":"","headerImage":"","featuredImage":"","description":"Gestion de session utilisateurs pour suivre des opérations sur des ressources & déploiement de SPA sur le cloud","autoMargin":true}},"allImages":{"edges":[{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='512'%20height='512'%20viewBox='0%200%20512%20512'%20preserveAspectRatio='none'%3e%3crect%20width='100%25'%20height='100%25'%20fill='gray'/%3e%3cpath%20d='M227%202a256%20256%200%201059%20509A256%20256%200%2000227%202m7%2054c-82%209-150%2068-172%20147l-2%208%20120%20121c116%20116%20121%20120%20124%20119%2021-4%2052-19%2074-35%2047-35%2079-98%2079-154v-6H329v36h44l43%201a167%20167%200%2001-97%20115l-8%203-105-105-105-105%203-8a165%20165%200%2001287-32l27-23a202%20202%200%2000-184-82M56%20267a200%20200%200%2000196%20189L56%20260v7'%20fill='green'%20fill-rule='evenodd'/%3e%3c/svg%3e"},"images":{"fallback":{"src":"/web3/static/53aa06cf17e4239d0dba6ffd09854e02/0cbce/icon.png","srcSet":"/web3/static/53aa06cf17e4239d0dba6ffd09854e02/0cbce/icon.png 512w","sizes":"100vw"},"sources":[{"srcSet":"/web3/static/53aa06cf17e4239d0dba6ffd09854e02/cc23f/icon.webp 512w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1}},"base":"icon.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='544'%20height='492'%20viewBox='0%200%20544%20492'%20preserveAspectRatio='none'%3e%3crect%20width='100%25'%20height='100%25'%20fill='gray'/%3e%3cpath%20d='M146%207c-31%208-51%2035-50%2068%201%2015%203%2020%2023%2056a3456%203456%200%200090%20151%2053177%2053177%200%200182%20145c16%2029%2018%2031%2026%2039a66%2066%200%2000113-47c0-19-1-20-33-75l-28-49h52c56%200%2064%200%2075-4a67%2067%200%2000-2-127l-8-2-39-1h-39l17-30c22-38%2023-41%2023-59%200-13%200-15-2-22a66%2066%200%2000-110-25c-8%208-9%2010-35%2055l-28%2048-28-47c-27-46-28-48-36-56a64%2064%200%2000-63-18'%20fill='green'%20fill-rule='evenodd'/%3e%3c/svg%3e"},"images":{"fallback":{"src":"/web3/static/309e0fb8b4416829acfed4f7a501206b/98149/logo_vinci.png","srcSet":"/web3/static/309e0fb8b4416829acfed4f7a501206b/98149/logo_vinci.png 544w","sizes":"100vw"},"sources":[{"srcSet":"/web3/static/309e0fb8b4416829acfed4f7a501206b/5eade/logo_vinci.webp 544w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.9044117647058824}},"base":"logo_vinci.png"}}]}},"pageContext":{"slug":"/modules/8/"}},"staticQueryHashes":["1696221415","3028011774","3458129946","493526238","501654901","575455071"]}